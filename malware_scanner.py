import os

# List of known malicious file signatures (example only, not comprehensive)
malicious_signatures = [
    "4d5a90000300000004000000ffff0000b8000000", # Example signature
]

def scan_file(file_path):
    try:
        with open(file_path, 'rb') as file:
            file_content = file.read()
            file_hex = file_content.hex()
            for signature in malicious_signatures:
                if signature in file_hex:
                    print(f"Malicious file detected: {file_path}")
                    return True
    except Exception as e:
        print(f"Error scanning file {file_path}: {e}")
    return False

def scan_directory(directory):
    for root, _, files in os.walk(directory):
        for file in files:
            file_path = os.path.join(root, file)
            scan_file(file_path)

if __name__ == "__main__":
    directory_to_scan = input("Enter the directory to scan: ")
    scan_directory(directory_to_scan)
